*** ./smali/android/content/pm/PackageParser.smali	2014-10-11 10:20:32.280208660 +1100
--- /home/cosmicdan/patchrom_mtk/bang/temp/new_smali/framework.jar.out/./smali/android/content/pm/PackageParser.smali	2014-10-11 10:17:28.324204670 +1100
***************
*** 21,27 ****
          Landroid/content/pm/PackageParser$ParseComponentArgs;,
          Landroid/content/pm/PackageParser$ParsePackageItemArgs;,
          Landroid/content/pm/PackageParser$SplitPermissionInfo;,
!         Landroid/content/pm/PackageParser$NewPermissionInfo;
      }
  .end annotation
  
--- 21,28 ----
          Landroid/content/pm/PackageParser$ParseComponentArgs;,
          Landroid/content/pm/PackageParser$ParsePackageItemArgs;,
          Landroid/content/pm/PackageParser$SplitPermissionInfo;,
!         Landroid/content/pm/PackageParser$NewPermissionInfo;,
!         Landroid/content/pm/PackageParser$Injector;
      }
  .end annotation
  
***************
*** 6525,6533 ****
      move-result v7
  
      .local v7, priority:I
      move-object/from16 v0, p5
  
!     invoke-virtual {v0, v7}, Landroid/content/pm/PackageParser$IntentInfo;->setPriority(I)V
  
      const/4 v13, 0x0
  
--- 6526,6540 ----
      move-result v7
  
      .local v7, priority:I
+     move/from16 v0, p4
+ 
+     invoke-static {v0, v7}, Landroid/content/pm/PackageParser$Injector;->checkPriority(II)I
+ 
+     move-result v13
+ 
      move-object/from16 v0, p5
  
!     invoke-virtual {v0, v13}, Landroid/content/pm/PackageParser$IntentInfo;->setPriority(I)V
  
      const/4 v13, 0x0
  
***************
*** 7373,7378 ****
--- 7380,7391 ----
  
      invoke-static {v0, v3}, Landroid/content/pm/PackageParser;->validateName(Ljava/lang/String;Z)Ljava/lang/String;
  
+     move-result-object v3
+ 
+     move-object/from16 v0, v35
+ 
+     invoke-static {v0, v3}, Landroid/content/pm/PackageParser$Injector;->filterNameError(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+ 
      move-result-object v30
  
      .local v30, nameError:Ljava/lang/String;
***************
*** 9564,9569 ****
--- 9577,9586 ----
  
      invoke-static {v6, v12}, Landroid/content/pm/PackageParser;->validateName(Ljava/lang/String;Z)Ljava/lang/String;
  
+     move-result-object v12
+ 
+     invoke-static {v6, v12}, Landroid/content/pm/PackageParser$Injector;->filterNameError(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+ 
      move-result-object v4
  
      .local v4, nameError:Ljava/lang/String;
***************
*** 10188,10193 ****
--- 10205,10214 ----
      :cond_5
      invoke-static {v1, v7}, Landroid/content/pm/PackageParser;->validateName(Ljava/lang/String;Z)Ljava/lang/String;
  
+     move-result-object v4
+ 
+     invoke-static {v1, v4}, Landroid/content/pm/PackageParser$Injector;->filterNameError(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
+ 
      move-result-object v0
  
      .local v0, nameError:Ljava/lang/String;
***************
*** 10958,10964 ****
  
      .restart local v6       #p:Landroid/content/pm/PackageParser$Provider;
      :cond_2
!     const/4 v15, 0x0
  
      .local v15, providerExportedDefault:Z
      move-object/from16 v0, p1
--- 10979,10985 ----
  
      .restart local v6       #p:Landroid/content/pm/PackageParser$Provider;
      :cond_2
!     const/4 v15, 0x1
  
      .local v15, providerExportedDefault:Z
      move-object/from16 v0, p1
***************
*** 13387,13392 ****
--- 13408,13427 ----
      .local v13, localCerts:[Ljava/security/cert/Certificate;
      if-nez v13, :cond_5
  
+     move-object/from16 v0, p1
+ 
+     iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
+ 
+     move-object/from16 v18, v0
+ 
+     move-object/from16 v0, v18
+ 
+     invoke-static {v12, v0}, Lmiui/content/pm/ExtraPackageManager;->isTrustedAppEntry(Ljava/util/jar/JarEntry;Ljava/lang/String;)Z
+ 
+     move-result v18
+ 
+     if-nez v18, :cond_3
+ 
      const-string v18, "PackageParser"
  
      new-instance v19, Ljava/lang/StringBuilder;
***************
*** 14072,14078 ****
      .local v25, cookie:I
      if-eqz v25, :cond_4
  
!     new-instance v32, Landroid/content/res/Resources;
  
      const/4 v6, 0x0
  
--- 14107,14113 ----
      .local v25, cookie:I
      if-eqz v25, :cond_4
  
!     new-instance v32, Landroid/content/res/MiuiResources;
  
      const/4 v6, 0x0
  
***************
*** 14080,14086 ****
  
      move-object/from16 v1, p3
  
!     invoke-direct {v0, v5, v1, v6}, Landroid/content/res/Resources;-><init>(Landroid/content/res/AssetManager;Landroid/util/DisplayMetrics;Landroid/content/res/Configuration;)V
      :try_end_1
      .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
  
--- 14115,14121 ----
  
      move-object/from16 v1, p3
  
!     invoke-direct {v0, v5, v1, v6}, Landroid/content/res/MiuiResources;-><init>(Landroid/content/res/AssetManager;Landroid/util/DisplayMetrics;Landroid/content/res/Configuration;)V
      :try_end_1
      .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0
  
