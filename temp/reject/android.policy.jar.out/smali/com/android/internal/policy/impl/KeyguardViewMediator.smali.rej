*** KeyguardViewMediator.smali	2014-10-11 10:20:56.244209180 +1100
--- KeyguardViewMediator.smali	2014-10-11 10:17:55.064205250 +1100
***************
*** 337,343 ****
      check-cast v2, Landroid/view/WindowManager;
  
      .local v2, wm:Landroid/view/WindowManager;
!     new-instance v0, Lcom/android/internal/policy/impl/KeyguardViewManager;
  
      iget-object v4, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mKeyguardViewProperties:Lcom/android/internal/policy/impl/KeyguardViewProperties;
  
--- 339,345 ----
      check-cast v2, Landroid/view/WindowManager;
  
      .local v2, wm:Landroid/view/WindowManager;
!     new-instance v0, Lcom/android/internal/policy/impl/MiuiKeyguardViewManager;
  
      iget-object v4, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mKeyguardViewProperties:Lcom/android/internal/policy/impl/KeyguardViewProperties;
  
***************
*** 1183,1188 ****
  
      .local v0, lockedOrMissing:Z
      :goto_2
      const-string v4, "KeyguardViewMediator"
  
      new-instance v5, Ljava/lang/StringBuilder;
--- 1187,1196 ----
  
      .local v0, lockedOrMissing:Z
      :goto_2
+     invoke-direct {p0, v0, v2, v3}, Lcom/android/internal/policy/impl/KeyguardViewMediator;->resetLockedOrMissing(ZZLcom/android/internal/telephony/IccCardConstants$State;)Z
+ 
+     move-result v0
+ 
      const-string v4, "KeyguardViewMediator"
  
      new-instance v5, Ljava/lang/StringBuilder;
***************
*** 1652,1672 ****
      .catchall {:try_start_1 .. :try_end_1} :catchall_0
      .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
  
-     :goto_1
-     :try_start_2
-     iget-object v0, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mUpdateMonitor:Lcom/android/internal/policy/impl/KeyguardUpdateMonitor;
- 
-     invoke-static {}, Lcom/android/internal/policy/impl/KeyguardUpdateMonitor;->isAlarmBoot()Z
- 
-     move-result v0
- 
-     if-nez v0, :cond_1
- 
-     const/4 v0, 0x1
- 
-     invoke-direct {p0, v0}, Lcom/android/internal/policy/impl/KeyguardViewMediator;->playSounds(Z)V
- 
      :goto_2
      iget-object v0, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mShowKeyguardWakeLock:Landroid/os/PowerManager$WakeLock;
  
      invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V
--- 1673,1680 ----
      .catchall {:try_start_1 .. :try_end_1} :catchall_0
      .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
  
      :goto_2
+     :try_start_2
      iget-object v0, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mShowKeyguardWakeLock:Landroid/os/PowerManager$WakeLock;
  
      invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V
***************
*** 1700,1711 ****
      :try_end_3
      .catchall {:try_start_3 .. :try_end_3} :catchall_0
  
!     goto :goto_2
  
      :catch_0
      move-exception v0
  
!     goto :goto_1
  .end method
  
  .method private handleTimeout(I)V
--- 1708,1719 ----
      :try_end_3
      .catchall {:try_start_3 .. :try_end_3} :catchall_0
  
!     goto :goto_1
  
      :catch_0
      move-exception v0
  
!     goto :goto_2
  .end method
  
  .method private handleTimeout(I)V
***************
*** 2372,2377 ****
      return-void
  .end method
  
  .method public isAlarmUnlockScreen()Z
      .locals 1
  
--- 2418,2466 ----
      return-void
  .end method
  
+ .method public doKeyguardTimeout(Landroid/os/Bundle;)V
+     .locals 3
+     .parameter "options"
+ 
+     .prologue
+     const/16 v2, 0xd
+ 
+     iget-object v1, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mHandler:Landroid/os/Handler;
+ 
+     invoke-virtual {v1, v2}, Landroid/os/Handler;->removeMessages(I)V
+ 
+     iget-object v1, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mHandler:Landroid/os/Handler;
+ 
+     invoke-virtual {v1, v2, p1}, Landroid/os/Handler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;
+ 
+     move-result-object v0
+ 
+     .local v0, msg:Landroid/os/Message;
+     iget-object v1, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mHandler:Landroid/os/Handler;
+ 
+     invoke-virtual {v1, v0}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
+ 
+     return-void
+ .end method
+ 
+ .method getContext()Landroid/content/Context;
+     .locals 1
+ 
+     .prologue
+     iget-object v0, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mContext:Landroid/content/Context;
+ 
+     return-object v0
+ .end method
+ 
+ .method getStatusBarManager()Landroid/app/StatusBarManager;
+     .locals 1
+ 
+     .prologue
+     iget-object v0, p0, Lcom/android/internal/policy/impl/KeyguardViewMediator;->mStatusBarManager:Landroid/app/StatusBarManager;
+ 
+     return-object v0
+ .end method
+ 
  .method public isAlarmUnlockScreen()Z
      .locals 1
  
