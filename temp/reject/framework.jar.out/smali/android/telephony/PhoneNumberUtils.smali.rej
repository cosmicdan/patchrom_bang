*** PhoneNumberUtils.smali	2014-10-11 10:20:19.636208386 +1100
--- PhoneNumberUtils.smali	2014-10-11 10:17:14.952204380 +1100
***************
*** 1568,1581 ****
  
      if-ge v6, v7, :cond_b
  
!     invoke-virtual {p0}, Ljava/lang/String;->length()I
  
      move-result v11
  
      sub-int v2, v11, v8
  
      .local v2, effectiveALen:I
!     invoke-virtual {p1}, Ljava/lang/String;->length()I
  
      move-result v11
  
--- 1581,1594 ----
  
      if-ge v6, v7, :cond_b
  
!     invoke-static {p0}, Landroid/telephony/PhoneNumberUtils$Injector;->getEffectiveLength(Ljava/lang/String;)I
  
      move-result v11
  
      sub-int v2, v11, v8
  
      .local v2, effectiveALen:I
!     invoke-static {p1}, Landroid/telephony/PhoneNumberUtils$Injector;->getEffectiveLength(Ljava/lang/String;)I
  
      move-result v11
  
***************
*** 3422,3427 ****
      .parameter "defaultCountryIso"
  
      .prologue
      invoke-virtual {p0}, Ljava/lang/String;->length()I
  
      move-result v1
--- 3435,3444 ----
      .parameter "defaultCountryIso"
  
      .prologue
+     invoke-static {p0}, Lmiui/telephony/PhoneNumberUtils;->removeDashesAndBlanks(Ljava/lang/String;)Ljava/lang/String;
+ 
+     move-result-object p0
+ 
      invoke-virtual {p0}, Ljava/lang/String;->length()I
  
      move-result v1
***************
*** 4972,4981 ****
  
      invoke-static {v10, v11}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
-     const/4 v10, 0x0
- 
-     goto/16 :goto_0
- 
      .end local v0           #arr$:[Ljava/lang/String;
      .end local v5           #i$:I
      .end local v6           #len$:I
--- 4989,4994 ----
  
      invoke-static {v10, v11}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
      .end local v0           #arr$:[Ljava/lang/String;
      .end local v5           #i$:I
      .end local v6           #len$:I
***************
*** 5108,5113 ****
      goto/16 :goto_0
  
      :cond_10
      const/4 v10, 0x0
  
      goto/16 :goto_0
--- 5121,5143 ----
      goto/16 :goto_0
  
      :cond_10
+     invoke-static {p0}, Lmiui/telephony/PhoneNumberUtils;->parseNumber(Ljava/lang/String;)Ljava/lang/String;
+ 
+     move-result-object p0
+ 
+     const/4 v10, 0x0
+ 
+     invoke-static {p0, v10}, Lmiui/telephony/PhoneNumberUtils;->isMiuiEmergencyNumber(Ljava/lang/String;Z)Z
+ 
+     move-result v10
+ 
+     if-eqz v10, :cond_miui_0
+ 
+     const/4 v10, 0x1
+ 
+     goto/16 :goto_0
+ 
+     :cond_miui_0
      const/4 v10, 0x0
  
      goto/16 :goto_0
***************
*** 6014,6030 ****
  .end method
  
  .method public static isSpecialEmergencyNumber(Ljava/lang/String;)Z
!     .locals 1
      .parameter "dialString"
  
      .prologue
!     sget-object v0, Landroid/telephony/PhoneNumberUtils;->mPhoneNumberExt:Lcom/mediatek/common/telephony/IPhoneNumberExt;
  
!     invoke-interface {v0, p0}, Lcom/mediatek/common/telephony/IPhoneNumberExt;->isSpecialEmergencyNumber(Ljava/lang/String;)Z
  
!     move-result v0
  
!     return v0
  .end method
  
  .method private static isSpecialMmiNumber(Ljava/lang/String;)Z
--- 6044,6065 ----
  .end method
  
  .method public static isSpecialEmergencyNumber(Ljava/lang/String;)Z
!     .locals 2
      .parameter "dialString"
  
      .prologue
!     invoke-static {p0}, Lmiui/telephony/PhoneNumberUtils;->parseNumber(Ljava/lang/String;)Ljava/lang/String;
  
!     move-result-object v0
  
!     .local v0, number:Ljava/lang/String;
!     const/4 v1, 0x0
  
!     invoke-static {v0, v1}, Lmiui/telephony/PhoneNumberUtils;->isMiuiEmergencyNumber(Ljava/lang/String;Z)Z
! 
!     move-result v1
! 
!     return v1
  .end method
  
  .method private static isSpecialMmiNumber(Ljava/lang/String;)Z
***************
*** 9585,9590 ****
      move-result v0
  
      .local v0, c:C
      const/16 v5, 0xa
  
      invoke-static {v0, v5}, Ljava/lang/Character;->digit(CI)I
--- 9620,9627 ----
      move-result v0
  
      .local v0, c:C
+     invoke-static {v4, v0, v2}, Landroid/telephony/PhoneNumberUtils$Injector;->appendNonSeparator(Ljava/lang/StringBuilder;CI)V
+ 
      const/16 v5, 0xa
  
      invoke-static {v0, v5}, Ljava/lang/Character;->digit(CI)I
